!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],i):i((e="undefined"!=typeof globalThis?globalThis:e||self).FeatureToggleComponentWrapper={},e.vue)}(this,(function(e,i){"use strict";function t(e){if(e&&e.__esModule)return e;var i=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(i,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),i.default=e,Object.freeze(i)}var n=t(i);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=function(e){return"boolean"==typeof e?function(){return e}:e},u=function(e,i){var t=e.toLowerCase();return"string"==typeof i&&(t+="#"+i.toLowerCase()),t};function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i={};return Object.keys(e).forEach((function(t){t.startsWith("_")||(i[u(t)]=a(e[t]))})),i}var l=new function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i={datas:{},listeners:{},visibilities:o(e),showLogs:!1,usedPlugins:[]};function t(i){if(e._plugins){if(!Array.isArray(e._plugins))throw new Error("featuretoggleapi()-constructor: config.plugins must be an array.");e._plugins.forEach((function(e){if("function"!=typeof e)throw new Error("featuretoggleapi()-constructor: config.plugins needs functions as entries, not "+r(e)+".");n(e,i)}))}l("init")}function n(e,i){e(i)}function l(e,t){(i.listeners[e]||[]).forEach((function(e){e(t)}))}var s=function(e){if(i.showLogs)if("undefined"!=typeof window){var t=-1!=e.indexOf("<b>"),n=-1!=e.indexOf("visible"),r=-1!=e.indexOf("hidden"),a=e.replace("visible","%cvisible");if(a=a.replace("hidden","%chidden"),n)console.log(a,"color:green;font-weight:bold;");else if(r)console.log(a,"color:red;font-weight:bold;");else if(t){var u=[a=a.replace("<b>","%c"),"font-weight:bold;"];console.log.apply(null,u)}else console.log(e)}else{var o=e.replace(/<b>/g,"");console.log(o)}},f=function(e,i){return s(i),s(""),e},c=function(e,i,t,n,r){if(null!=e){var a=e({name:t,variant:n,data:r});return"boolean"==typeof a?a:f(!1,"The ".concat(i," returns ").concat(a,". => Please return true or false. This result (and all non-boolean results) will return false."))}};function d(e){var t=e.split("#");return{name:t[0],variant:t.length>1?t[1]:void 0,data:i.datas[e]}}function b(e,i,t,n){if(null==e)throw new Error("feature.visibility(): 1st parameter name must be defined");if(1==arguments.length)throw new Error("feature.visibility(): 2nd parameter name must be a boolean or function, but is empty");var r=null,a=null,u=null;return null==t&&null==n?u=i:null==n?(r=i,u=t):(r=i,a=t,u=n),{name:e,variant:r,data:a,result:u}}function h(e,i,t,n){var r;return(r={name:e,variant:i,data:t}).key=u(r.name,r.variant),null==n||(r.visibilityFunction=a(n),r.result=r.visibilityFunction({name:r.name,variant:r.variant,data:r.data||{},_internalCall:!0,description:"When attaching a function, the result must be calculated internally. You can filter this out with the _internalCall:true -Flag."})),r}function v(e,t,n){var r=i.visibilities;if(s('\nCheck Visibility of <b>Feature "'.concat(e,'", variant "').concat(null==t?"":t,'"').concat(n?" with data "+JSON.stringify(n):"",".")),null==e)throw new Error('The attribute "name" is required for tag <feature></feature>. Example: <feature name="aname"></feature>');var a=r._required,o=null!=r._required,l=c(a,"requiredVisibility",e,t,n),d=u(e,t),b=r[d],h=null!=r[d],v=c(b,"visibility function",e,t,n),y=null!=t,g=u(e,null),p=r[g];r[g];var m=c(p,"visibility function (only name)",e,t,n),w=r._default,T=null!=r._default,V=c(w,"defaultVisibility",e,t,n);if(o){if(o&&!0===l)s("The requiredVisibility rule returns true. This feature will be shown when no other rule rejects it.");else if(o&&!1===l)return f(!1,"The requiredVisibility rule returns false. This feature will be hidden.")}else s("No requiredVisibility rule specified for this feature.");return h?f(v,"The visibility rule returns ".concat(v,". This feature will be ").concat(v?"visible":"hidden",".")):(s("No visibility rule found matching name and variant."),y&&"boolean"==typeof m?f(m,"Found a visibility rule for name ".concat(e," without variants. The rule returns ").concat(m,". => This feature will be ").concat(m?"visible":"hidden",".")):(y&&s("No rules found for name ".concat(e," without variants.")),T?f(V,"Found a defaultVisibility rule. The rule returns ".concat(V,". => This feature will be ").concat(V?"visible":"hidden",".")):(s("No default rule found."),o?f(!0,"Only the requiredVisibility rule was found. This returned true. => This feature will be visible."):f(!1,"No rules were found. This feature will be hidden."))))}var y={name:"feature-toggle-api",setData:function(e,t,n){if(null==e)throw new Error("setData(): The name must of the feature must be defined, but ist undefined");var r=h(e,null!=n?t:void 0,n||t);i.datas[r.key]=r.data,l("visibilityrule",r)},on:function(e,t,n){i.listeners[e]=i.listeners[e]||[],i.listeners[e].push(t),l("registerEvent",{type:e}),null!=n&&n.ignorePreviousRules||Object.keys(i.visibilities).forEach((function(e){var n=d(e),r=i.visibilities[e];n.result=r(n),t(n)}))},trigger:l,showLogs:function(e){i.showLogs=null==e||e},isVisible:v,visibility:function(e,t,n,r){var a=b(e,t,n,r),u=h(a.name,a.variant,a.data,a.result);i.visibilities[u.key]=u.visibilityFunction,i.datas[u.key]=u.data,l("visibilityrule",u)},requiredVisibility:function(e){if("function"!=typeof e)throw new Error("feature.requiredVisibility(): 1st parameter must be a function, but is "+r(e));i.visibilities._required=a(e)},defaultVisibility:function(e){if("function"!=typeof e)throw new Error("feature.defaultVisibility(): 1st parameter must be a function, but is "+r(e));i.visibilities._default=a(e)},addPlugin:function(e){i.usedPlugins.includes(e)||(n(e,y),i.usedPlugins.push(e))}};return t(y),y};l.addPlugin((function(e){Object.assign(e,{props:{name:{type:String},variant:{type:String},data:{type:[Object,String]},tag:{type:String,default:"div"}},name:"feature",data:function(){return{isVisible:e.isVisible(this.name,this.variant,this.data)}},render:function(e){var i;if(this.isVisible)return(n.h||e)(this.tag,{"feature-name":this.name,"feature-variant":this.variant},"function"==typeof(i=this.$slots.default)?i():i)},methods:{_isVisible:function(i,t,n){return e.isVisible(i,t,n)}}})})),e.FeatureToggleComponent=l,Object.defineProperty(e,"__esModule",{value:!0})}));var FeatureToggleComponent=FeatureToggleComponentWrapper.FeatureToggleComponent;
